<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Better Discord - Modern Chat</title>
  <link rel="stylesheet" href="styles.css">
  <link  href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.css" rel="stylesheet" />
  <script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script>
</head>
<body>
  <div class="app-container">
    <!-- Sidebar: Servers -->
    <nav class="sidebar">
      <button class="friends-btn" title="Friends" aria-label="Friends">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="8" r="4.5" stroke="currentColor" stroke-width="1.7"/>
          <path d="M4.5 20c0-3.1 3.1-5.5 7.5-5.5s7.5 2.4 7.5 5.5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
        </svg>
      </button>
      <ul class="server-list">
        <!-- Servers will be dynamically added here -->
      </ul>
      <button class="add-server" title="Create Server">+</button>
    </nav>
    <!-- Channel List -->
    <aside class="channels">
      <div class="channels-header"># Channels</div>
      <ul class="channel-list">
        <!-- Channels will be dynamically added here -->
      </ul>
      <button type="button" class="add-friend-btn" style="display:none;">+ Add Friend</button>
    </aside>
    <!-- Main Chat Area -->
    <main class="chat">
      <header class="chat-header">
        <h2 class="channel-title"><!-- Channel name --></h2>
        <div class="chat-actions">
          <button class="search-btn icon-btn" title="Search" aria-label="Search">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="7"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
          </button>
          <div class="search-bar-container" style="display:none;">
            <input type="text" class="search-bar-input" placeholder="Search messages..." />
            <button class="search-bar-arrow search-bar-arrow-up" title="Previous match" aria-label="Previous match">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 12 10 8 14 12"/></svg>
            </button>
            <button class="search-bar-arrow search-bar-arrow-down" title="Next match" aria-label="Next match">
              <svg width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 8 10 12 14 8"/></svg>
            </button>
            <button class="search-bar-close icon-btn" title="Close search" aria-label="Close search">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><line x1="6" y1="6" x2="14" y2="14"/><line x1="14" y1="6" x2="6" y2="14"/></svg>
            </button>
          </div>
          <button title="Settings">⚙️</button>
        </div>
      </header>
      <section class="messages">
        <!-- Messages will be dynamically added here -->
      </section>
      <div id="welcome-message" class="welcome-message">
        <dotlottie-player
          src="https://lottie.host/3e696694-9fb5-4b0f-9718-7079bbaab5f2/7oyhIyDpOj.lottie"
          background="transparent"
          speed="1"
          style="width: 300px; height: 300px"
          loop
          autoplay>
        </dotlottie-player>
        <h2>Welcome! Select a server or channel to get started.</h2>
      </div>
      <form class="chat-input">
        <button type="button" class="chat-attach-btn icon-btn" title="Attach file" aria-label="Attach file">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        </button>
        <input type="file" class="chat-file-input" style="display:none;" accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar,.7z,.csv" />
        <input type="text" placeholder="Type a message..." />
        <button type="submit">Send</button>
      </form>
    </main>
    <!-- User Profile -->
    <aside class="user-profile">
      <div class="profile-lottie-bg">
        <dotlottie-player src="https://lottie.host/6199b42a-f1b9-4ea3-b0ac-8c9e1d88135f/ZtxUFZ7wE0.lottie" background="transparent" speed="1" style="width: 100%; height: 100%;" loop autoplay></dotlottie-player>
      </div>
      <div class="profile-banner-container">
        <img src="" alt="Banner" class="profile-banner" style="display:none;">
        <video src="" class="profile-banner-video" style="display:none; width:100%; height:100%; object-fit:cover;" autoplay loop muted playsinline></video>
        <input type="hidden" class="banner-crop-data" />
      </div>
      <div class="profile-avatar-wrapper">
        <div class="profile-avatar-circle">
          <img src="" class="profile-avatar" alt="Avatar" style="display:none;">
          <button class="change-avatar-btn" title="Change Avatar">
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 2.5L17.5 6.5M3 13.5L13.5 3L17 6.5L6.5 17H3V13.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>
      <div class="profile-main-info">
        <div class="profile-name-row">
          <span class="profile-name-editable">
            <span class="profile-name">Username</span>
            <input type="text" class="profile-name-input" style="display:none;" />
          </span>
          <button class="edit-name-btn" title="Edit Name">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 2.5L17.5 6.5M3 13.5L13.5 3L17 6.5L6.5 17H3V13.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
          <button class="save-name-btn" style="display:none;">Save</button>
          <button class="cancel-name-btn" style="display:none;">Cancel</button>
        </div>
        <div class="profile-id-row">
          <span class="profile-id">#0000</span>
          <button class="copy-id-btn" title="Copy ID">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="5" width="10" height="10" rx="2" stroke="currentColor" stroke-width="1.5"/><rect x="2.5" y="2.5" width="10" height="10" rx="2" stroke="currentColor" stroke-width="1.5"/></svg>
          </button>
        </div>
        <div class="profile-bio-row">
          <span class="profile-bio-editable">
            <span class="profile-bio">This is your bio. Tell us about yourself!</span>
            <textarea class="profile-bio-input" style="display:none;"></textarea>
          </span>
          <button class="edit-bio-btn icon-btn" title="Edit Bio">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.5 2.5L17.5 6.5M3 13.5L13.5 3L17 6.5L6.5 17H3V13.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </button>
        </div>
      </div>
      <div class="profile-actions">
        <button class="view-full-profile-btn">View Full Profile</button>
        <button class="change-banner-btn" title="Change Banner">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="7" width="14" height="10" rx="2" stroke="currentColor" stroke-width="1.5"/><circle cx="10" cy="12" r="2.5" stroke="currentColor" stroke-width="1.5"/><rect x="7" y="3" width="6" height="2" rx="1" fill="currentColor"/></svg>
        </button>
        <button class="logout-account-btn">Logout</button>
        <button class="delete-account-btn">Delete Account</button>
        <div class="delete-caution">⚠️ Deleting your account is permanent and cannot be undone.</div>
      </div>
    </aside>
  </div>
  <div id="create-server-modal" class="modal" style="display:none;">
    <div class="modal-content">
      <button class="modal-close" title="Close">&times;</button>
      <h2>Customize Your Server</h2>
      <p>Give your new server a personality with a name and an icon. You can always change it later.</p>
      <div class="icon-upload-area">
        <label for="server-icon-upload" class="icon-upload-label">
          <span class="icon-upload-circle">
            <span class="icon-upload-plus">+</span>
            <span class="icon-upload-camera">&#128247;</span>
          </span>
          <span class="icon-upload-text">UPLOAD</span>
          <input type="file" id="server-icon-upload" accept="image/*" style="display:none;" />
        </label>
      </div>
      <label for="server-name" class="server-name-label">SERVER NAME</label>
      <input type="text" id="server-name" class="server-name-input" placeholder="" />
      <div class="modal-actions">
        <button class="modal-back">Back</button>
        <button class="modal-create" disabled>Create</button>
      </div>
    </div>
  </div>
  <div class="auth-overlay" id="auth-overlay">
    <div class="auth-left">
      <div class="cube-3d-container">
        <div class="scene">
          <div class="pivot">
            <div class="cube">
              <div class="face front"></div>
              <div class="face back"></div>
              <div class="face right"></div>
              <div class="face left"></div>
              <div class="face top"></div>
              <div class="face bottom"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="auth-logo animated-logo">
        <span class="logo-m">M</span>
        <span class="logo-s">S</span>
        <span class="logo-i">I</span>
      </div>
      <div class="auth-heading" id="auth-heading">
        <span class="heading-stack" style="position:relative;display:inline-block;">
          <span id="auth-heading-top">YOUR PLACE TO</span>
          <span id="auth-heading-bottom">CONNECT & GROW</span>
        </span>
      </div>
      <div class="auth-desc" id="auth-desc">
        At MSI, we believe in fostering vibrant communities. Whether you're collaborating on a project, sharing ideas with a group, or just chatting with friends, MSI provides a seamless platform for all your interactions.
      </div>
    </div>
    <div class="auth-right">
      <div class="auth-form-container">
        <div class="auth-message" id="auth-message" style="display:none;"></div>
        <form class="auth-form auth-login" id="auth-login-form">
          <div class="auth-title">Welcome Back!</div>
          <div class="auth-subtitle">We're so excited to see you again!</div>
          <label>Display Name
            <input type="text" id="login-display-name" placeholder="Enter your display name" required />
          </label>
          <label>Password
            <input type="password" id="login-password" placeholder="Enter your password" required />
          </label>
          <div class="auth-links">
            <a href="#" id="forgot-password">Forgot your password?</a>
          </div>
          <button type="submit" class="auth-btn">Login</button>
          <div class="auth-switch">Need an account? <a href="#" id="show-signup">Register</a></div>
        </form>
        <form class="auth-form auth-signup" id="auth-signup-form" style="display:none;">
          <div class="auth-title">Create Account</div>
          <div class="auth-subtitle">Join MSI and start connecting!</div>
          <label>Display Name
            <input type="text" id="signup-display-name" placeholder="Choose a display name" required />
          </label>
          <label>Password
            <input type="password" id="signup-password" placeholder="Create a password" required />
          </label>
          <button type="submit" class="auth-btn">Register</button>
          <div class="auth-switch">Already have an account? <a href="#" id="show-login">Login</a></div>
        </form>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bcryptjs@2.4.3/dist/bcrypt.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.js"></script>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script src="app.js"></script>

  <!-- Cropper Modal -->
  <div id="cropper-modal" style="display:none; position:fixed; z-index:3000; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.85); align-items:center; justify-content:center;">
    <div id="cropper-loading">
      <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%;">
        <div class="spinner"></div>
        <div style="color:#fff; margin-top:16px; font-size:1.1rem;">Uploading...</div>
      </div>
    </div>
    <div class="cropper-modal-content" style="background:var(--background-secondary); padding:32px 24px; border-radius:16px; box-shadow:0 2px 16px var(--shadow); display:flex; flex-direction:column; align-items:center; position:relative; z-index:10;">
      <img id="cropper-image" src="" style="max-width:60vw; max-height:60vh; border-radius:12px; margin-bottom:18px;" />
      <div style="display:flex; gap:16px;">
        <button id="cropper-cancel" style="background:#444; color:#fff; border:none; border-radius:8px; padding:10px 24px; font-size:1rem; cursor:pointer;">Cancel</button>
        <button id="cropper-confirm" style="background:var(--accent); color:#fff; border:none; border-radius:8px; padding:10px 24px; font-size:1rem; cursor:pointer;">Crop & Upload</button>
      </div>
    </div>
  </div>
  <div id="bio-feedback" style="display:none; position:fixed; top:32px; right:32px; z-index:5000; background:none; box-shadow:none; padding:0;">
    <svg id="bio-feedback-svg" width="48" height="48" viewBox="0 0 48 48">
      <circle cx="24" cy="24" r="18" stroke="#8f6ee8" stroke-width="4" fill="none" stroke-linecap="round"/>
      <path d="M16 25 L22 31 L33 19" stroke="#8f6ee8" stroke-width="4" fill="none" stroke-linecap="round"/>
    </svg>
  </div>
  <div class="success-popup" id="server-success-popup">
    <div class="success-content">
      <svg id="server-success-svg" width="80" height="80" viewBox="0 0 48 48">
        <circle cx="24" cy="24" r="18" stroke="#8f6ee8" stroke-width="4" fill="none" stroke-linecap="round"/>
        <path d="M16 25 L22 31 L33 19" stroke="#8f6ee8" stroke-width="4" fill="none" stroke-linecap="round"/>
      </svg>
    </div>
  </div>
  <div id="add-friend-modal" class="modal" style="display:none;">
    <div class="modal-content add-friend-modal-content">
      <button class="modal-close add-friend-modal-close" title="Close">&times;</button>
      <h2 class="add-friend-heading" style="display:flex;align-items:center;gap:10px;">
        <span style="font-size:1.4em; color:var(--accent);">&#128101;</span>
        <span>Add Friends</span>
      </h2>
      <form class="add-friend-form" autocomplete="off" style="display:flex;gap:12px;margin:24px 0 18px 0;">
        <input type="text" class="add-friend-input" placeholder="Enter friend's ID..." style="flex:1;" />
        <button type="submit" class="add-friend-send-btn">Send</button>
      </form>
      <div class="add-friend-section">
        <div class="add-friend-section-title">Incoming Friend Requests</div>
        <div class="add-friend-request-row">
          <span class="add-friend-request-username">ghost77</span>
          <button class="add-friend-accept-btn">Accept</button>
          <button class="add-friend-reject-btn">Reject</button>
        </div>
      </div>
      <div class="add-friend-section">
        <div class="add-friend-section-title">Sent Requests</div>
        <div class="add-friend-request-row">
          <span class="add-friend-request-username">coolguy42</span>
          <span class="add-friend-request-status">(Pending)</span>
        </div>
      </div>
    </div>
  </div>
</body>
</html> 